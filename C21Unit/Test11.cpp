#include <stdio.h>
#include <stdlib.h>
#include "../C21/Strategy.h"
#include "../C21/Game.h"

#define SPLIT4_ROW 17

/*
running tests: 1
test 00:
 0  0.088  0.076  0.025  0.014  0.013  0.276  0.278  0.284  1.228  0.394
 1  0.473  0.451  0.398  0.389  0.387  0.667  0.660  0.666  2.967  0.773
 2  0.429  0.359  0.307  0.295  0.295  0.595  0.613  0.622  2.479  0.649
 3  0.429  0.406  0.355  0.337  0.336  0.619  0.614  0.635  2.631  0.686
 4  0.514  0.476  0.423  0.412  0.412  0.699  0.679  0.687  2.805  0.729
 5  0.503  0.479  0.415  0.402  0.402  0.622  0.626  0.632  2.593  0.675
 6  0.554  0.531  0.465  0.457  0.454  0.641  0.639  0.642  2.636  0.686
 7  0.531  0.512  0.459  0.452  0.453  0.576  0.583  0.587  2.410  0.626
 8  0.626  0.599  0.550  0.528  0.527  0.614  0.592  0.595  2.434  0.631
 9  0.565  0.543  0.534  0.528  0.524  0.559  0.535  0.540  2.202  0.570
10  0.333  0.320  0.319  0.325  0.323  0.326  0.313  0.314  1.228  0.309
11  0.249  0.249  0.250  0.256  0.253  0.244  0.230  0.229  0.915  0.230
12  0.230  0.231  0.232  0.237  0.237  0.224  0.210  0.211  0.847  0.211
13  0.152  0.151  0.151  0.153  0.151  0.146  0.139  0.138  0.556  0.139
14  0.142  0.141  0.141  0.148  0.147  0.141  0.132  0.131  0.524  0.131
15  0.068  0.068  0.068  0.074  0.073  0.068  0.065  0.065  0.258  0.065
16  0.073  0.074  0.073  0.073  0.073  0.073  0.062  0.062  0.247  0.062
17  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000
18  0.063  0.062  0.061  0.062  0.061  0.062  0.062  0.062  0.250  0.062
19  0.062  0.063  0.062  0.062  0.062  0.063  0.062  0.062  0.248  0.062
20  0.062  0.062  0.062  0.062  0.062  0.062  0.062  0.061  0.250  0.062
21  0.062  0.062  0.062  0.062  0.062  0.062  0.062  0.061  0.248  0.062
22  0.067  0.068  0.067  0.067  0.068  0.062  0.068  0.069  0.247  0.061
23  0.067  0.068  0.068  0.068  0.068  0.068  0.068  0.068  0.271  0.068
24  0.068  0.068  0.068  0.068  0.068  0.068  0.062  0.063  0.249  0.062
25  0.066  0.068  0.068  0.068  0.068  0.062  0.062  0.062  0.249  0.062
26  0.062  0.062  0.062  0.062  0.062  0.063  0.062  0.062  0.249  0.062
27  0.061  0.062  0.062  0.068  0.068  0.062  0.062  0.062  0.248  0.063
28  0.068  0.068  0.068  0.067  0.067  0.068  0.062  0.062  0.249  0.062
29  0.067  0.068  0.068  0.068  0.068  0.068  0.062  0.063  0.249  0.062
30  0.031  0.031  0.031  0.031  0.031  0.031  0.031  0.031  0.125  0.031
31  0.031  0.031  0.031  0.031  0.032  0.031  0.031  0.032  0.124  0.031
32  0.031  0.031  0.030  0.031  0.031  0.031  0.032  0.031  0.125  0.031
33  0.031  0.031  0.031  0.030  0.031  0.031  0.031  0.031  0.124  0.031
34  0.031  0.031  0.031  0.031  0.031  0.031  0.031  0.031  0.123  0.032
35  0.036  0.037  0.037  0.036  0.036  0.031  0.037  0.036  0.124  0.031
36  0.036  0.037  0.037  0.037  0.037  0.037  0.037  0.037  0.147  0.037
37  0.037  0.037  0.037  0.036  0.037  0.037  0.031  0.031  0.124  0.031
38  0.037  0.036  0.037  0.036  0.037  0.031  0.031  0.031  0.124  0.031
39  0.031  0.032  0.031  0.031  0.031  0.031  0.031  0.031  0.124  0.031
40  0.031  0.031  0.031  0.037  0.036  0.031  0.031  0.031  0.125  0.031
41  0.037  0.036  0.037  0.037  0.036  0.036  0.031  0.030  0.124  0.031
42  0.037  0.036  0.036  0.037  0.037  0.037  0.031  0.031  0.124  0.030
row = 17 analysis
0. 54
1. 42
2. 46
3. 49
4. 68
5. 51
6. 0
7. 0
8. 0
9. 0
total = 29324989 min = 3923 row = 0 col = 4
*/
void test11() {
	Strategy bs = BasicStrategy_();

	Game statistics = start(&bs, 20000000, 0);

	int* plays = getPlays();

	double total = 0;
	for (int index = 0; index < NUMBER_RULES; index++)
		total += plays[index];

	int minPlays = INT_MAX;
	int minRow = -1;
	int minCol = -1;

	for(int row=0; row < NUMBER_RULES/10; row++) {
		printf("%2d ", row);
		for (int col = 0; col < 10; col++) {
			int index = row * 10 + col;
			int count = plays[index];

			double prob = count / total * 100;

			printf("%6.3f ",prob);

			if (row != SPLIT4_ROW && count < minPlays) {
				minPlays = count;
				minRow = row;
				minCol = col;
			}
		}
		printf("\n");
	}

	int row = SPLIT4_ROW;

	printf("row = %d analysis\n", row);

	for (int col = 0; col < 10; col++)
		printf("%d. %d\n", col, plays[row * 10 + col]);


	printf("total = %d min = %d row = %d col = %d\n",(int)total, minPlays, minRow, minCol);
}