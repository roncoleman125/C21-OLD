#include <stdio.h>
#include <time.h>
#include "../C21/Game.h"
#include "../C21/Strategy.h"

/*! Tests 50 rounds of 2M games.
running tests: 1
test 00:
       pl hands     wins      blackjack charlies  loses     breaks    dealerbjs pushes
-0.007079 2059930   801083    94667     0         579756    345391    65125     173908
-0.004122 2059809   804698    94276     0         577789    345444    64814     172788
-0.004666 2060083   802930    95144     0         578931    344728    64569     173781
-0.003077 2060070   805548    94265     0         577928    344200    65055     173074
-0.004536 2059416   802922    94944     0         577503    345509    64659     173879
-0.004879 2059606   803659    94305     0         578178    345298    64840     173326
-0.004779 2060157   803649    94632     0         579132    344744    64835     173165
-0.003931 2059673   804863    94594     0         578022    344884    65279     172031
-0.005764 2059918   803215    94655     0         579236    345350    65106     172356
-0.004665 2059798   803736    94215     0         578557    344171    64907     174212
-0.004506 2060158   803137    95111     0         578970    344604    64565     173771
-0.005175 2060396   803535    94576     0         578897    345268    65231     172889
-0.004137 2059460   803996    94880     0         578256    344476    65253     172599
-0.004002 2060061   804387    94740     0         578303    344245    65161     173225
-0.004992 2060249   803631    94544     0         578187    345012    65456     173419
-0.005115 2060017   803241    94468     0         578005    345715    65378     173210
-0.005624 2059584   802726    94855     0         578384    345797    65058     172764
-0.004831 2059884   804072    94251     0         578356    345431    64778     172996
-0.003738 2059916   804483    94992     0         577946    345020    64482     172993
-0.005204 2059905   803181    95123     0         578749    345239    65115     172498
-0.005216 2059592   802947    94524     0         578266    345382    65063     173410
-0.005246 2059722   803279    94637     0         578165    346199    64720     172722
-0.006225 2059721   801744    94712     0         579470    345378    64835     173582
-0.005114 2060032   803666    94018     0         578541    344631    64854     174322
-0.005281 2059384   802283    95016     0         579133    345079    64409     173464
-0.005336 2059840   803266    94571     0         579540    344480    64673     173310
-0.003523 2060122   804270    94875     0         577458    345140    64851     173528
-0.005551 2060048   802816    94451     0         578591    345399    65280     173511
-0.004653 2060705   804516    94543     0         578704    344984    65010     172948
-0.004445 2060146   804025    94587     0         578695    344679    65027     173133
-0.005115 2059937   803961    94639     0         578749    345185    64803     172600
-0.005474 2060379   803123    94591     0         579137    345294    64739     173495
-0.004540 2060008   804499    94362     0         577850    345342    64835     173120
-0.004558 2059895   803855    94892     0         577780    345418    65308     172642
-0.004408 2060248   804054    94638     0         579256    344499    64829     172972
-0.005129 2059846   803216    94900     0         578888    344683    65194     172965
-0.006073 2060518   802637    94595     0         579053    345319    65282     173632
-0.004827 2059612   803882    94623     0         577378    346044    65035     172650
-0.006181 2060185   802618    94515     0         579211    345827    64985     173029
-0.006270 2059672   801711    95140     0         579206    345171    65091     173353
-0.004139 2060102   804818    94622     0         578516    344401    64776     172969
-0.004601 2059816   804050    94574     0         578264    345079    64912     172937
-0.005657 2059576   802776    94300     0         577803    345953    65382     173362
-0.005571 2059404   803504    94175     0         578839    345559    64610     172717
-0.004986 2060272   803816    94459     0         579334    344232    64852     173579
-0.004726 2060229   803661    94771     0         578758    345607    64693     172739
-0.005681 2059970   802423    94763     0         577886    345742    65269     173887
-0.004699 2059635   803087    95008     0         577895    345624    64893     173128
-0.004700 2060085   803778    94722     0         577835    345021    65303     173426
-0.004987 2060100   803856    94383     0         579242    344838    64486     173295
time: 326.000
PASSED!

mean(pl) = -0.004955
stderr(pl) = 0.000746
CV = 15%

References:
1. https://wizardofodds.com/games/blackjack/appendix/1/, last accessed 5 May 2018
2. https://en.wikipedia.org/wiki/Aces_and_eights_(blackjack), last accessed 10 May 2018
*/
void test10() {
	Strategy bs = BasicStrategy_();

	time_t t0_ = time(NULL);
	//clock_t t0 = clock();

	printf("%9s %-9s %-9s %-9s %-9s %-9s %-9s %-9s %-9s\n",
		"pl", "hands", "wins","blackjack","charlies","loses","breaks","dealerbjs","pushes");

	for (int gameno = 0; gameno < 50; gameno++) {
		Game statistics = start(&bs, 2000000, gameno);

		output(&statistics, 0);
	}

	//clock_t t1 = clock();
	time_t t1_ = time(NULL);

	//clock_t dt = (t1 - t0);
	double dt_ = difftime(t1_, t0_);

	printf("time: %6.3f\n", dt_);
}